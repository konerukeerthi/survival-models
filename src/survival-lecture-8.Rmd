---
title: "survival lecture 8"
author: "Steve Simon"
date: "April 8, 2018"
output: html_document
---

Lecture 8. Frailty models. You can incorporate mutliple events per patient and account for center effects using frailty models, the survival data analysis equivalent to mixed models in linear regression. Youâ€™ll see how to define random effects and how to fit and interpret these models.

This file does not need any special libraries other than the ones listed below. Many of the data sets in this program use data from Hosmer, Lemeshow, and May. I made one minor change, however, which was to force all the variable names to lower case.

```{r load-libraries}
library(broom)
library(dplyr)
library(ggplot2)
library(magrittr)
library(survival)
library(tidyr)
```

## Recurrent events model

Hosmer, Lemeshow, and May describe a recurrent events model on page 293 that uses the Psoriasis data.

```{r read-psoriasis}
fn <- "~/survival-models/data/wiley/recur.dat" 
psoriasis <- read.table(fn, header = FALSE) 
names(psoriasis) <- c(
  "id",
  "age",
  "treat",
  "time0",
  "time1",
  "censor",
  "event")
head(psoriasis)
```

## Frailty model

Hosmer, Lemeshow, and May describe a frailty model using a data set with variables bmi, hr, diasbp, and chf.

## Nested case-control study

It's not on the syllabus, but depending on how things work out, I might want to look at a nested case control study. If I do, the relevant data set is acth320ncc.

```{r read-ncc}
fn <- "~/survival-models/data/wiley/actg320ncc.dat" 
ncc <- read.table(fn, header = FALSE) 
head(ncc)
```

## Competing risk models

Also not on the syllabus is the competing risk model. But the examples presented in Hosmer, Lemeshow, and May (pages 329-339) are hypothetical. The data management looks daunting, as in Table 9.9.


Save everything for possible later re-use.

```{r save-everything}
save.image("~/survival-models/bin/survival-lecture-8.RData")
```